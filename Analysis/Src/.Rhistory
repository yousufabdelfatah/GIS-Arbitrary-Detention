rename_with(str_to_title) %>%
summarise_all(sum) %>%
rename("Poor Treatment" = Poor_treatment) %>%
pivot_longer(everything(),
names_to = "Condition",
values_to = "Incidence") %>%
ggplot(aes(area = Incidence, fill = Condition,
label = paste(Condition, Incidence, sep = "\n"))) +
treemapify::geom_treemap() +
treemapify::geom_treemap_text(colour = "black",
place = "centre",
size = 15) +
theme(legend.position = "none")
joined_data %>%
as_tibble() %>%
select(42:51) %>%
mutate(across(everything(), as.character)) %>%
replace(!is.na(.), '1') %>%
replace(is.na(.), '0') %>%
mutate(across(everything(), as.numeric)) %>%
rename_with(str_to_title) %>%
summarise_all(sum) %>%
rename("Poor Treatment" = Poor_treatment) %>%
pivot_longer(everything(),
names_to = "Condition",
values_to = "Incidence") %>%
ggplot(aes(area = Incidence, fill = Condition,
label = paste(Condition, Incidence, sep = "\n"))) +
treemapify::geom_treemap() +
treemapify::geom_treemap_text(colour = "black",
place = "centre",
size = 15) +
theme(legend.position = "none") +
ggtitle("Prevalence of Issues in Detention Conditions")
joined_data %>%
as_tibble() %>%
select(42:51) %>%
mutate(across(everything(), as.character)) %>%
replace(!is.na(.), '1') %>%
replace(is.na(.), '0') %>%
mutate(across(everything(), as.numeric)) %>%
rename_with(str_to_title) %>%
summarise_all(sum) %>%
rename("Poor Treatment" = Poor_treatment) %>%
pivot_longer(everything(),
names_to = "Condition",
values_to = "Incidence") %>%
ggplot(aes(area = Incidence, fill = Condition,
label = paste(Condition, Incidence, sep = "\n"))) +
treemapify::geom_treemap() +
treemapify::geom_treemap_text(colour = "black",
place = "centre",
size = 15) +
theme(legend.position = "none") +
ggtitle("Prevalence of Issues in Detention Conditions") +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(42:51) %>%
mutate(across(everything(), as.character)) %>%
replace(!is.na(.), '1') %>%
replace(is.na(.), '0') %>%
mutate(across(everything(), as.numeric)) %>%
rename_with(str_to_title) %>%
summarise_all(sum) %>%
rename("Poor Treatment" = Poor_treatment) %>%
pivot_longer(everything(),
names_to = "Condition",
values_to = "Incidence") %>%
ggplot(aes(area = Incidence, fill = Condition,
label = paste(Condition, Incidence, sep = "\n"))) +
treemapify::geom_treemap() +
treemapify::geom_treemap_text(colour = "black",
place = "centre",
size = 15) +
theme(legend.position = "none") +
ggtitle("Figure 3: Prevalence of Issues in Detention Conditions") +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
arrange(Incidence) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col() +
coord_flip()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
arrange(Incidence) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col() +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Age")+
geom_density(color = "orange", size = 1.5) +
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
arrange(Incidence) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col() +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
geom_density(color = "orange", size = 1.5) +
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
arrange(Incidence) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(color = "orange") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
arrange(Incidence) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "purple") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
arrange(Incidence) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
rename("Threaten Family" = threaten_family) %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename("Threaten Family" = threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_few() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
ggthemes::theme_tufte() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_classic()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_light()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_minimal()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_line()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_linedraw()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_test()
joined_data %>%
as_tibble() %>%
select(beating,
electrocution,
threaten_family,
hanging) %>%
replace(is.na(.), 0) %>%
summarise(beating = sum(beating),
electrocution = sum(electrocution),
threaten_family = sum(threaten_family),
hanging = sum(hanging)) %>%
rename_with(str_to_title) %>%
rename("Threaten Family" = Threaten_family) %>%
pivot_longer(everything(),
names_to = "Method",
values_to = "Incidence") %>%
ggplot(aes(reorder(Method, -Incidence), Incidence)) +
geom_col(fill = "red") +
coord_flip() +
labs(title="Figure 4: Subjection to Torture",
x= "Method")+
theme_test() +
theme(plot.title = element_text(hjust = 0.5))
joined_data %>%
as_tibble() %>%
select(42:51) %>%
mutate(across(everything(), as.character)) %>%
replace(!is.na(.), '1') %>%
replace(is.na(.), '0') %>%
mutate(across(everything(), as.numeric)) %>%
rename_with(str_to_title) %>%
summarise_all(sum) %>%
rename("Poor Treatment" = Poor_treatment) %>% %>%
select(-Strike) %>%
pivot_longer(everything(),
names_to = "Condition",
values_to = "Incidence") %>%
ggplot(aes(area = Incidence, fill = Condition,
label = paste(Condition, Incidence, sep = "\n"))) +
treemapify::geom_treemap() +
treemapify::geom_treemap_text(colour = "black",
place = "centre",
size = 15) +
theme(legend.position = "none") +
ggtitle("Figure 3: Prevalence of Issues in Detention Conditions") +
theme(plot.title = element_text(hjust = 0.5))
source('~/Desktop/Fall 2021/Data Viz/Project/Analysis/Src/data_analysis.R', echo=TRUE)
joined_data %>%
#as_tibble() %>%
group_by(ADM1_REF) %>%
summarise(n = n()) %>%
ggplot() +
geom_sf(aes(fill = n)) +
scale_fill_viridis_c(option = "magma", direction = -1, name = 'Detainees') +
theme_void() +
labs(title = 'Figure 2: Number of Detainees Per Governate') +
theme(plot.title = element_text(hjust = 0.5)) +
theme(legend.position = "bottom")
View(egypt)
